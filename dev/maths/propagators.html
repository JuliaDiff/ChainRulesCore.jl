<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>The propagators: pushforward and pullback · ChainRules</title><meta name="title" content="The propagators: pushforward and pullback · ChainRules"/><meta property="og:title" content="The propagators: pushforward and pullback · ChainRules"/><meta property="twitter:title" content="The propagators: pushforward and pullback · ChainRules"/><meta name="description" content="Documentation for ChainRules."/><meta property="og:description" content="Documentation for ChainRules."/><meta property="twitter:description" content="Documentation for ChainRules."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/indigo.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../index.html"><img src="../assets/logo.svg" alt="ChainRules logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">ChainRules</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Introduction</a></li><li><span class="tocitem">How to use ChainRules as a rule author</span><ul><li><a class="tocitem" href="../rule_author/intro.html">Introduction</a></li><li><a class="tocitem" href="../rule_author/example.html">Pedagogical example</a></li><li><a class="tocitem" href="../rule_author/tangents.html">Tangent types</a></li><li><a class="tocitem" href="../rule_author/which_functions_need_rules.html">Which functions need rules?</a></li><li><a class="tocitem" href="../rule_author/rule_definition_tools.html">Rule definition tools</a></li><li><a class="tocitem" href="../rule_author/writing_good_rules.html">Writing good rules</a></li><li><a class="tocitem" href="../rule_author/testing.html">Testing your rules</a></li><li><input class="collapse-toggle" id="menuitem-2-8" type="checkbox"/><label class="tocitem" for="menuitem-2-8"><span class="docs-label">Superpowers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../rule_author/superpowers/projectto.html"><code>ProjectTo</code></a></li><li><a class="tocitem" href="../rule_author/superpowers/opt_out.html"><code>@opt_out</code></a></li><li><a class="tocitem" href="../rule_author/superpowers/ruleconfig.html"><code>RuleConfig</code></a></li><li><a class="tocitem" href="../rule_author/superpowers/gradient_accumulation.html">Gradient accumulation</a></li><li><a class="tocitem" href="../rule_author/superpowers/mutation_support.html">Mutation Support (experimental)</a></li></ul></li><li><a class="tocitem" href="../rule_author/converting_zygoterules.html">Converting ZygoteRules.@adjoint to rrules</a></li><li><a class="tocitem" href="../rule_author/tips_for_packages.html">Tips for making your package work with AD</a></li><li><a class="tocitem" href="../rule_author/debug_mode.html">Debug mode</a></li></ul></li><li><span class="tocitem">How to support ChainRules rules as an AD package author</span><ul><li><a class="tocitem" href="../ad_author/use_in_ad_system.html">Usage in AD</a></li><li><a class="tocitem" href="../ad_author/call_back_into_ad.html">Support calling back into ADs</a></li><li><a class="tocitem" href="../ad_author/opt_out.html">Support opting out of rules</a></li></ul></li><li><span class="tocitem">The maths</span><ul><li class="is-active"><a class="tocitem" href="propagators.html">The propagators: pushforward and pullback</a></li><li><a class="tocitem" href="nondiff_points.html">Non-differentiable Points</a></li><li><a class="tocitem" href="complex.html">Complex numbers</a></li><li><a class="tocitem" href="arrays.html">Deriving array rules</a></li></ul></li><li><span class="tocitem">Design</span><ul><li><a class="tocitem" href="../design/changing_the_primal.html">Changing the Primal</a></li><li><a class="tocitem" href="../design/many_tangents.html">Many Tangent Types</a></li></ul></li><li><a class="tocitem" href="../videos.html">Videos</a></li><li><a class="tocitem" href="../FAQ.html">FAQ</a></li><li><a class="tocitem" href="../api.html">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">The maths</a></li><li class="is-active"><a href="propagators.html">The propagators: pushforward and pullback</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="propagators.html">The propagators: pushforward and pullback</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaDiff/ChainRulesCore.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaDiff/ChainRulesCore.jl/blob/main/docs/src/maths/propagators.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="The-propagators:-pushforward-and-pullback"><a class="docs-heading-anchor" href="#The-propagators:-pushforward-and-pullback">The propagators: pushforward and pullback</a><a id="The-propagators:-pushforward-and-pullback-1"></a><a class="docs-heading-anchor-permalink" href="#The-propagators:-pushforward-and-pullback" title="Permalink"></a></h1><div class="admonition is-category-terminology"><header class="admonition-header">pushforward and pullback</header><div class="admonition-body"><p><em>Pushforward</em> and <em>pullback</em> are fancy words that the autodiff community recently adopted from Differential Geometry. They are broadly in agreement with the use of <a href="https://en.wikipedia.org/wiki/Pullback_(differential_geometry)">pullback</a> and <a href="https://en.wikipedia.org/wiki/Pushforward_(differential)">pushforward</a> in differential geometry. But any geometer will tell you these are the super-boring flat cases. Some will also frown at you. They are also sometimes described in terms of the jacobian: The <em>pushforward</em> is <em>jacobian vector product</em> (<code>jvp</code>), and <em>pullback</em> is <em>jacobian transpose vector product</em> (<code>j&#39;vp</code>). Other terms that may be used include for <em>pullback</em> the <strong>backpropagator</strong>, and by analogy for <em>pushforward</em> the <strong>forwardpropagator</strong>, thus these are the <em>propagators</em>. These are also good names because effectively they propagate wiggles and wobbles through them, via the chain rule. (the term <strong>backpropagator</strong> may originate with <a href="http://www-bcl.cs.may.ie/~barak/papers/toplas-reverse.pdf">&quot;Lambda The Ultimate Backpropagator&quot;</a> by Pearlmutter and Siskind, 2008)</p></div></div><h3 id="Core-Idea"><a class="docs-heading-anchor" href="#Core-Idea">Core Idea</a><a id="Core-Idea-1"></a><a class="docs-heading-anchor-permalink" href="#Core-Idea" title="Permalink"></a></h3><h4 id="Less-formally"><a class="docs-heading-anchor" href="#Less-formally">Less formally</a><a id="Less-formally-1"></a><a class="docs-heading-anchor-permalink" href="#Less-formally" title="Permalink"></a></h4><ul><li>The <strong>pushforward</strong> takes a wiggle in the <em>input space</em>, and tells what wobble you would create in the output space, by passing it through the function.</li><li>The <strong>pullback</strong> takes wobbliness information with respect to the function&#39;s output, and tells the equivalent wobbliness with respect to the functions input.</li></ul><h4 id="More-formally"><a class="docs-heading-anchor" href="#More-formally">More formally</a><a id="More-formally-1"></a><a class="docs-heading-anchor-permalink" href="#More-formally" title="Permalink"></a></h4><p>The <strong>pushforward</strong> of <span>$f$</span> takes the <em>sensitivity</em> of the input of <span>$f$</span> to a quantity, and gives the <em>sensitivity</em> of the output of <span>$f$</span> to that quantity.</p><p>The <strong>pullback</strong> of <span>$f$</span> takes the <em>sensitivity</em> of a quantity to the output of <span>$f$</span>, and gives the <em>sensitivity</em> of that quantity to the input of <span>$f$</span>.</p><h3 id="Math"><a class="docs-heading-anchor" href="#Math">Math</a><a id="Math-1"></a><a class="docs-heading-anchor-permalink" href="#Math" title="Permalink"></a></h3><p>This is all a bit simplified by talking in 1D.</p><h4 id="Lighter-Math"><a class="docs-heading-anchor" href="#Lighter-Math">Lighter Math</a><a id="Lighter-Math-1"></a><a class="docs-heading-anchor-permalink" href="#Lighter-Math" title="Permalink"></a></h4><p>For a chain of expressions:</p><pre><code class="nohighlight hljs">a = f(x)
b = g(a)
c = h(b)</code></pre><p>The pullback of <code>g</code>, which incorporates the knowledge of <code>∂b/∂a</code>, applies the chain rule to go from <code>∂c/∂b</code> to <code>∂c/∂a</code>.</p><p>The pushforward of <code>g</code>,  which also incorporates the knowledge of <code>∂b/∂a</code>, applies the chain rule to go from <code>∂a/∂x</code> to <code>∂b/∂x</code>.</p><h4 id="Geometric-interpretation-of-reverse-and-forwards-mode-AD"><a class="docs-heading-anchor" href="#Geometric-interpretation-of-reverse-and-forwards-mode-AD">Geometric interpretation of reverse and forwards mode AD</a><a id="Geometric-interpretation-of-reverse-and-forwards-mode-AD-1"></a><a class="docs-heading-anchor-permalink" href="#Geometric-interpretation-of-reverse-and-forwards-mode-AD" title="Permalink"></a></h4><p>Let us think of our types geometrically. In other words, elements of a type form a <em>manifold</em>. This document will explain this point of view in some detail.</p><h5 id="Some-terminology/conventions"><a class="docs-heading-anchor" href="#Some-terminology/conventions">Some terminology/conventions</a><a id="Some-terminology/conventions-1"></a><a class="docs-heading-anchor-permalink" href="#Some-terminology/conventions" title="Permalink"></a></h5><p>Let <span>$p$</span> be an element of type <span>$M$</span>, which is defined by some assignment of numbers <span>$x_1, \dots, x_m$</span>, say <span>$(x_1, \dots, x_m) = (a_1, \dots, a_m)$</span></p><p>A <em>function</em> <span>$f:M \to K$</span> on <span>$M$</span> is (for simplicity) a polynomial <span>$K[x_1, \dots, x_m]$</span></p><p>The tangent space <span>$T_pM$</span> of <span>$M$</span> at point <span>$p$</span> is the <span>$K$</span>-vector space spanned by derivations <span>$d/dx$</span>. The tangent space acts linearly on the space of functions. They act as usual on functions. Our starting point is that we know how to write down <span>$d/dx(f) = df/dx$</span>.</p><p>The collection of tangent spaces <span>${T_pM}$</span> for <span>$p\in M$</span> is called the <em>tangent bundle</em> of <span>$M$</span>.</p><p>Let <span>$df$</span> denote the first order information of <span>$f$</span> at each point. This is called the differential of <span>$f$</span>. If the derivatives of <span>$f$</span> and <span>$g$</span> agree at <span>$p$</span>, we say that <span>$df$</span> and <span>$dg$</span> represent the same cotangent at <span>$p$</span>. The covectors <span>$dx_1, \dots, dx_m$</span> form the basis of the cotangent space <span>$T^*_pM$</span> at <span>$p$</span>. Notice that this vector space is dual to <span>$T_pM$</span>.</p><p>The collection of cotangent spaces <span>${T^*_pM}$</span> for <span>$p\in M$</span> is called the <em>cotangent bundle</em> of <span>$M$</span>.</p><h5 id="Push-forwards-and-pullbacks"><a class="docs-heading-anchor" href="#Push-forwards-and-pullbacks">Push-forwards and pullbacks</a><a id="Push-forwards-and-pullbacks-1"></a><a class="docs-heading-anchor-permalink" href="#Push-forwards-and-pullbacks" title="Permalink"></a></h5><p>Let <span>$N$</span> be another type, defined by numbers <span>$y_1,...,y_n$</span>, and let <span>$g:M \to N$</span> be a <em>map</em>, that is, an <span>$n$</span>-dimensional vector <span>$(g_1, ..., g_m)$</span> of functions on <span>$M$</span>.</p><p>We define the <em>push-forward</em> <span>$g_*:TM \to TN$</span> between tangent bundles by <span>$g_*(X)(h) = X(g\circ h)$</span> for any tangent vector <span>$X$</span> and function <span>$f$</span>. We have <span>$g_*(d/dx_i)(y_j) = dg_j/dx_i$</span>, so the push-forward corresponds to the Jacobian, given a chosen basis.</p><p>Similarly, the pullback of the differential <span>$df$</span> is defined by <span>$g^*(df) = d(f\circ g)$</span>. So for a coordinate differential <span>$dy_j$</span>, we have <span>$g^*(dy_j) = d(g_j)$</span>. Notice that this is a covector, and we could have defined the pullback by its action on vectors by <span>$g^*(dh)(X) = g_*(X)(dh) = X(g\circ h)$</span> for any function <span>$f$</span> on <span>$N$</span> and <span>$X\in TM$</span>. In particular, <span>$g^*(dy_j)(d/dx_i) = d(g_j)/dx_i$</span>. If you work out the action in a basis of the cotangent space, you see that it acts by the adjoint of the Jacobian.</p><p>Notice that the pullback of a differential and the pushforward of a vector have a very different meaning, and this should be reflected on how they are used in code.</p><p>The information contained in the push-forward map is exactly <em>what does my function do to tangent vectors</em>. Pullbacks, acting on differentials of functions, act by taking the total derivative of a function. This works in a coordinate invariant way, and works without the notion of a metric. <em>Gradients</em> recall are vectors, yet they should contain the same information of the differential <span>$df$</span>. Assuming we use the standard euclidean metric, we can identify <span>$df$</span> and <span>$\nabla f$</span> as vectors. But pulling back gradients still should not be a thing.</p><p>If the goal is to evaluate the gradient of a function <span>$f=g\circ h:M \to N \to K$</span>, where <span>$g$</span> is a map and <span>$h$</span> is a function, we have two obvious options: First, we may push-forward a basis of <span>$M$</span> to <span>$TK$</span> which we identify with K itself. This results in <span>$m$</span> scalars, representing components of the gradient. Step-by-step in coordinates:</p><ol><li>Compute the push-forward of the basis of <span>$T_pM$</span>, i.e. just the columns of the Jacobian <span>$dg_i/dx_j$</span>.</li><li>Compute the push-forward of the function <span>$h$</span> (consider it as a map, K is also a manifold!) to get <span>$h_*(g_*T_pM) = \sum_j dh/dy_i (dg_i/dx_j)$</span></li></ol><p>Second, we pull back the differential <span>$dh$</span>:</p><ol><li>compute <span>$dh = dh/dy_1,...,dh/dy_n$</span> in coordinates.</li><li>pull back by (in coordinates) multiplying with the adjoint of the Jacobian, resulting in <span>$g_*(dh) = \sum_i(dg_i/dx_j)(dh/dy_i)$</span>.</li></ol><h3 id="The-anatomy-of-pullback-and-pushforward"><a class="docs-heading-anchor" href="#The-anatomy-of-pullback-and-pushforward">The anatomy of pullback and pushforward</a><a id="The-anatomy-of-pullback-and-pushforward-1"></a><a class="docs-heading-anchor-permalink" href="#The-anatomy-of-pullback-and-pushforward" title="Permalink"></a></h3><p>For our function <code>foo(args...; kwargs...) = y</code>:</p><pre><code class="language-julia hljs">function pullback(Δy)
    ...
    return ∂self, ∂args...
end</code></pre><p>The input to the pullback is often called the <em>seed</em>. If the function is <code>y = f(x)</code> often the pullback will be written <code>s̄elf, x̄ = pullback(ȳ)</code>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The pullback returns one <code>∂arg</code> per <code>arg</code> to the original function, plus one <code>∂self</code> for the fields of the function itself (explained below).</p></div></div><div class="admonition is-category-terminology"><header class="admonition-header">perturbation, seed, sensitivity</header><div class="admonition-body"><p>Sometimes <em>perturbation</em>, <em>seed</em>, and even <em>sensitivity</em> will be used interchangeably. They are not generally synonymous, and ChainRules shouldn&#39;t mix them up. One must be careful when reading literature. At the end of the day, they are all <em>wiggles</em> or <em>wobbles</em>.</p></div></div><p>The pushforward is a part of the <code>frule</code> function. Considered alone it would look like:</p><pre><code class="language-julia hljs">function pushforward(Δself, Δargs...)
    ...
    return ∂y
end</code></pre><p>But because it is fused into frule we see it as part of:</p><pre><code class="language-julia hljs">function frule((Δself, Δargs...), ::typeof(foo), args...; kwargs...)
    ...
    return y, ∂y
end</code></pre><p>The input to the pushforward is often called the <em>perturbation</em>. If the function is <code>y = f(x)</code> often the pushforward will be written <code>ẏ = last(frule((ṡelf, ẋ), f, x))</code>. <code>ẏ</code> is commonly used to represent the perturbation for <code>y</code>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>In the <code>frule</code>/pushforward, there is one <code>Δarg</code> per <code>arg</code> to the original function. The <code>Δargs</code> are similar in type/structure to the corresponding inputs <code>args</code> (<code>Δself</code> is explained below). The <code>∂y</code> are similar in type/structure to the original function&#39;s output <code>Y</code>. In particular if that function returned a tuple then <code>∂y</code> will be a tuple of the same size.</p></div></div><h3 id="self_derivative"><a class="docs-heading-anchor" href="#self_derivative">Self derivative <code>Δself</code>, <code>∂self</code>, <code>s̄elf</code>, <code>ṡelf</code> etc</a><a id="self_derivative-1"></a><a class="docs-heading-anchor-permalink" href="#self_derivative" title="Permalink"></a></h3><div class="admonition is-category-terminology"><header class="admonition-header">Δself, ∂self, s̄elf, ṡelf</header><div class="admonition-body"><p>It is the derivatives with respect to the internal fields of the function. To the best of our knowledge there is no standard terminology for this. Other good names might be <code>Δinternal</code>/<code>∂internal</code>.</p></div></div><p>From the mathematical perspective, one may have been wondering what all this <code>Δself</code>, <code>∂self</code> is. Given that a function with two inputs, say <code>f(a, b)</code>, only has two partial derivatives: <span>$\dfrac{∂f}{∂a}$</span>, <span>$\dfrac{∂f}{∂b}$</span>. Why then does a <code>pushforward</code> take in this extra <code>Δself</code>, and why does a <code>pullback</code> return this extra <code>∂self</code>?</p><p>The reason is that in Julia the function <code>f</code> may itself have internal fields. For example a closure has the fields it closes over; a callable object (i.e. a functor) like a <code>Flux.Dense</code> has the fields of that object.</p><p><strong>Thus every function is treated as having the extra implicit argument <code>self</code>, which captures those fields.</strong> So every <code>pushforward</code> takes in an extra argument, which is ignored unless the original function has fields. It is common to write <code>function foo_pushforward(_, Δargs...)</code> in the case when <code>foo</code> does not have fields. Similarly every <code>pullback</code> returns an extra <code>∂self</code>, which for things without fields is <code>NoTangent()</code>, indicating there are no fields within the function itself.</p><p>Here&#39;s an example showing how to define <code>∂self</code> in an <code>rrule</code> when the primal function has internal fields (implicit arguments):</p><pre><code class="language-julia hljs">struct Multiplier{T}
    x::T
end
(m::Multiplier)(y) = m.x * y

function ChainRulesCore.rrule(m::Multiplier, y)
    product = m(y)
    function pullback(Δproduct) 
        ∂self = Tangent{Multiplier}(; x = Δproduct * y&#39;)
        ∂y = m.x&#39; * Δproduct
        return ∂self, ∂y
    end 
    return product, pullback
end</code></pre><h3 id="Pushforward-/-Pullback-summary"><a class="docs-heading-anchor" href="#Pushforward-/-Pullback-summary">Pushforward / Pullback summary</a><a id="Pushforward-/-Pullback-summary-1"></a><a class="docs-heading-anchor-permalink" href="#Pushforward-/-Pullback-summary" title="Permalink"></a></h3><ul><li><p><strong>Pullback</strong></p><ul><li>returned by <code>rrule</code></li><li>takes output space wobbles, gives input space wiggles</li><li>Argument structure matches structure of primal function output</li><li>If primal function returns a tuple, then pullback takes in a tuple of differentials.</li><li>1 return per original function argument + 1 for the function itself</li></ul></li><li><p><strong>Pushforward:</strong></p><ul><li>part of <code>frule</code></li><li>takes input space wiggles, gives output space wobbles</li><li>Argument structure matches primal function argument structure, but passed as a tuple at start of <code>frule</code></li><li>1 argument per original function argument + 1 for the function itself</li><li>1 return per original function return</li></ul></li></ul><h3 id="Pullback/Pushforward-and-Directional-Derivative/Gradient"><a class="docs-heading-anchor" href="#Pullback/Pushforward-and-Directional-Derivative/Gradient">Pullback/Pushforward and Directional Derivative/Gradient</a><a id="Pullback/Pushforward-and-Directional-Derivative/Gradient-1"></a><a class="docs-heading-anchor-permalink" href="#Pullback/Pushforward-and-Directional-Derivative/Gradient" title="Permalink"></a></h3><p>The most trivial use of the <code>pushforward</code> from within <code>frule</code> is to calculate the <a href="https://en.wikipedia.org/wiki/Directional_derivative">directional derivative</a>:</p><p>If we would like to know the directional derivative of <code>f</code> for an input change of <code>(1.5, 0.4, -1)</code></p><pre><code class="language-julia hljs">direction = (1.5, 0.4, -1) # (ȧ, ḃ, ċ)
y, ẏ = frule((ZeroTangent(), direction...), f, a, b, c)</code></pre><p>On the basis directions one gets the partial derivatives of <code>y</code>:</p><pre><code class="language-julia hljs">y, ∂y_∂a = frule((ZeroTangent(), 1, 0, 0), f, a, b, c)
y, ∂y_∂b = frule((ZeroTangent(), 0, 1, 0), f, a, b, c)
y, ∂y_∂c = frule((ZeroTangent(), 0, 0, 1), f, a, b, c)</code></pre><p>Similarly, the most trivial use of <code>rrule</code> and returned <code>pullback</code> is to calculate the <a href="https://en.wikipedia.org/wiki/Gradient">gradient</a>:</p><pre><code class="language-julia hljs">y, f_pullback = rrule(f, a, b, c)
∇f = f_pullback(1)  # for appropriate `1`-like seed.
s̄elf, ā, b̄, c̄ = ∇f</code></pre><p>Then we have that <code>∇f</code> is the <em>gradient</em> of <code>f</code> at <code>(a, b, c)</code>. And we thus have the partial derivatives <span>$\overline{\mathrm{self}} = \dfrac{∂f}{∂\mathrm{self}}$</span>, <span>$\overline{a} = \dfrac{∂f}{∂a}$</span>, <span>$\overline{b} = \dfrac{∂f}{∂b}$</span>, <span>$\overline{c} = \dfrac{∂f}{∂c}$</span>, including the <a href="propagators.html#self_derivative">self-partial derivative</a>, <span>$\overline{\mathrm{self}}$</span>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../ad_author/opt_out.html">« Support opting out of rules</a><a class="docs-footer-nextpage" href="nondiff_points.html">Non-differentiable Points »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Monday 23 June 2025 08:53">Monday 23 June 2025</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
